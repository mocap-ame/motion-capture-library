<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Movement UnderCommons</title>
    <link rel="icon" href="./res/frontpage/img/ico.png" type="image/png" />

    <!-- Lato Font -->
    <link href='http://fonts.googleapis.com/css?family=Lato:300,400,700' rel='stylesheet' type='text/css'>

    <script src="https://cdn.jsdelivr.net/npm/in-view@0.6.1/dist/in-view.min.js"></script>
    <!-- Stylesheet -->
    <link href="res/frontpage/css/gallery-materialize.min.css" rel="stylesheet">

    <!-- Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script>
function getXMLHTTPRequest()
{
    var request;
    // Lets try using ActiveX to instantiate the XMLHttpRequest object
    try{
        request = new ActiveXObject("Microsoft.XMLHTTP");
    }catch(ex1){
        try{
            request = new ActiveXObject("Msxml2.XMLHTTP");
        }catch(ex2){
            request = null;
        }
    }

    // If the previous didn't work, lets check if the browser natively support XMLHttpRequest
    if(!request && typeof XMLHttpRequest != "undefined"){
        //The browser does, so lets instantiate the object
        request = new XMLHttpRequest();
    }

    return request;
}


function loadFile(filename, callback)
{
    var aXMLHttpRequest = getXMLHTTPRequest();
    var allData;

    if (aXMLHttpRequest)
    {
        aXMLHttpRequest.open("GET", filename, true);

      aXMLHttpRequest.onreadystatechange = function (aEvt) {
        if(aXMLHttpRequest.readyState == 4){
        allData = aXMLHttpRequest.responseText;
        callback(allData)
        }
      };

      //Lets fire off the request
        aXMLHttpRequest.send(null);
    }
    else
    {
        //Oh no, the XMLHttpRequest object couldn't be instantiated.
        alert("A problem occurred instantiating the XMLHttpRequest object.");
    }
}
    </script>
  </head>

  <body onload='start()'>

    <!-- Navbar and Header -->
    <nav class="nav-extended">
      <div class="nav-background" style='background-color:transparent'>
        <div class="pattern active" style=";"></div>
      </div>
      <div class="nav-wrapper container">
        <a href="index.html" class="brand-logo">
          <img src='res/frontpage/img/ame.png' height=90
        </a>
        <a href="#" data-activates="nav-mobile" class="button-collapse"><i class="material-icons">menu</i></a>
        <ul class="right hide-on-med-and-down">
          <li class="active"><a href="about.html">About</a></li>
        </ul>

        <div class="nav-header center">
          <h1 style='text-shadow: 2px 4px 3px  0px 4px 3px rgba(0,0,0,0.4),
             0px 8px 13px rgba(0,0,0,0.1),
             0px 18px 23px rgba(0,0,0,0.1);'>
            MOVEMENT <br> UNDERCOMMONS</h1>
          <div style='text-shadow: 0 1px 0 rgba(255, 255, 255, 0.4);font-size: 20px;margin-top:20px;text-transform:uppercase'
            class="tagline">A Motion Capture Repository</div>
        </div>
      </div>

      <!-- Fixed Masonry Filters -->
      <div class="categories-wrapper lighten">
        <div class="categories-container">
          <ul class="categories container">
            <li class="active"><a href="#all">All</a></li>
            <li><a href="#polygon">Polygon</a></li>
            <li><a href="#bigbang">Big Bang</a></li>
            <li><a href="#sacred">Sacred Geometry</a></li>
          </ul>
        </div>
      </div>
    </nav>
    <ul class="side-nav" id="nav-mobile">
      <li class="active"><a href="index.html"><i class="material-icons">camera</i>Gallery</a></li>
      <li><a href="index-dark.html"><i class="material-icons">brightness_3</i>Dark Theme</a></li>
      <li><a href="blog.html"><i class="material-icons">edit</i>Blog</a></li>
      <li><a href="docs.html"><i class="material-icons">school</i>Docs</a></li>
      <li><a href="full-header.html"><i class="material-icons">fullscreen</i>Fullscreen Header</a></li>
      <li><a href="horizontal.html"><i class="material-icons">swap_horiz</i>Horizontal Style</a></li>
      <li><a href="no-image.html"><i class="material-icons">texture</i>No Image Expand</a></li>
    </ul>

    <!-- Gallery -->
    <div id="portfolio" class="section gray">
      <div class="container">
        <div class="gallery row" id="theGallery">




        </div>

      </div>

    </div><!-- /.container -->


    <button onclick="minFullScreen(event)" id='closeButton' style='
        position:fixed;top:10px;right:10px;z-index:999999;display:none;
      ' class="btn-floating btn-large waves-effect waves-light active"><i class="material-icons" style="background:#FFC627;color:black">close</i></button>

    <!-- Core Javascript -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="res/frontpage/js/imagesloaded.pkgd.min.js"></script>
    <script src="res/frontpage/js/masonry.pkgd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/materialize/0.98.0/js/materialize.min.js"></script>
    <script src="res/frontpage/js/color-thief.min.js"></script>
    <script src="res/frontpage/js/galleryExpand.js"></script>
    <script src="res/frontpage/js/init.js"></script>

  </body>
  <script>
  var itemMarkup =
    '<div class="gallery-curve-wrapper">'+
      '<a class="gallery-cover gray" style="display:block;box-shadow:none">'+
        '<iframe class="responsive-img responsive-iframe" src="./res/bvhplayer/three.js-dev/examples/webgl_loader_bvh_fat.html" alt="placeholder"></iframe>'+
      '</a>'+
      '<div class="gallery-header" style="background-color:#000000;color:#FFC627;">'+
        '<span>__TITLE__</span>'+
      '</div>'+
      '<div class="gallery-body" style="background:black;color:white">'+
        '<div class="title-wrapper">'+
          '<h3>__TITLE__</h3>'+
          '<span class="price">__DURATION__</span>'+
        '</div>'+
        '<div class="description">__DESC__'+
        '</div>'+
      '</div>'+
      '<div class="gallery-action">'+
        '<button onclick="doFullScreen(event)" class="btn-floating btn-large waves-effect waves-light"><i class="material-icons" style="background:#FFC627;color:black">play_arrow</i></button>'+
      '</div>'+
    '</div>'+
    '<div class="itemCover"></div>'


  var styleT = ""
  function doFullScreen(e)
  {
    styleT = $(e.target).closest(".gallery-item").find(".gallery-cover").attr("style");
    $(e.target).closest(".gallery-item").find(".gallery-cover")[0].style = "position:absolute;width:100%;height:100%;left:0;top:0;margin-left:0"
    $(e.target).closest(".gallery-item").find(".gallery-cover").addClass("fullscreen");
    $(e.target).closest(".gallery-item").find(".gallery-action").fadeOut(0);
    $("#placeholder-navbar").fadeOut(0);
    $("#closeButton").fadeIn(100);
  }

  function minFullScreen()
  {
    $("#closeButton").fadeOut(100);
    $(".gallery-item .gallery-cover").removeClass("fullscreen");
    $(".gallery-item .gallery-action").fadeIn(0);
    $("#placeholder-navbar").fadeIn(0);
    $(".gallery-item .gallery-cover.static")[0].style =  styleT

  }

  var app;
  var appt;
  function start()
  {
    loadFile("./data/package.json", function(data){
      appt = data
      app = JSON.parse(data);
      var mu = "";
      var mcs = Object.keys(app.mocaps);
      for(var i = 0; i < mcs.length; i++){
        mu += 
  '<div class="col l4 m6 s12 gallery-item gallery-expand gallery-filter __TAGS__" data-count="'+ i +'" data-bvh="__BVHFILE__" id="item_' + mcs[i]+ '">'+
          itemMarkup + '</div>';
      }
      document.getElementById("theGallery").innerHTML = mu;
      init()
      for(var i = 0; i < mcs.length; i++){
        var infoFile = app.mocaps[mcs[i]].info;
        function y(c, x){
         loadFile("data/files/"+ mcs[c] + "/" + x, function(data){
           var obj = JSON.parse(data);
           $("#item_" + mcs[c] + " .title-wrapper h3").html(obj.title)
           $("#item_" + mcs[c] + " .gallery-header span").html(obj.title)
          console.log(c, data);
         })
        }
        y(i, infoFile);
      }
    });
  }
  </script>


<style>
html{
}
body,html{
  background: url(res/frontpage/img/hotel-wallpaper-black.png);
  background-attachment:fixed;
  background-size:500px;
  background-color:black;
}

  nav.nav-extended{
    background-color: transparent;
    background-image: url('res/frontpage/img/header.jpg');
    background-position: 50%;
    background-size:cover;
  }
  .lighten {
    background-color: rgb(53,53,53) !important;
  }
  .fullscreen.gallery-cover.static{
    position:absolute;
    top:0;
    left:0;
    min-height: 100vh;
    min-width:100vw;
    transform: scale(1);
  }
  .fullscreen.gallery-cover.static iframe{
    min-height:100vh;
    width:100vw;
  }

  .responsive-iframe{
    width: 100%;
    height: 35vh;
    border:none;
  }
  nav#placeholder-navbar .nav-wrapper{
    background: #121212;
  }
  .active .placeholder{
    border-radius: 0px;
  }
  .placeholder:hover{
    box-shadow:0px 0px 50px #FFC627;
  }
  .gallery .gallery-header{
    color:#FFC627;
    background-color: #000000;
    margin-top:-10px;
  }
  .itemCover{
    position:absolute;
    top:0;
    left:0;
    width: 100%;
    height: 100%;
    z-index:100;
  }
  .gallery-item{
    position:relative;
  }
  .placeholder{
    border-radius: 24px;
    overflow: hidden;
  }
  .gallery-curve-wrapper{
    position:relative;
  }
</style>
</html>
